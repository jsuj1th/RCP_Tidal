# Quick Reference Guide

## UI Changes at a Glance

### Legend (Top-Right of Canvas)
```
Before:                          After:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Legend          â”‚             â”‚ Anomaly Status  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ”´ Critical     â”‚             â”‚ ğŸ”´ Critical     â”‚
â”‚ ğŸŸ  Review Req   â”‚             â”‚ ğŸŸ  Review Req   â”‚
â”‚ ğŸŸ¢ Normal       â”‚             â”‚ ğŸŸ¢ Normal       â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ ğŸŸ¢ Tap          â”‚  â† REMOVED
â”‚ ğŸ”µ Tee          â”‚  â† REMOVED
â”‚ â–¬  Weld         â”‚  â† REMOVED
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Show Joint Labels Feature
```
Toggle OFF:                     Toggle ON:
                               
    â•â•â•â•â•â•â•â•â•â•â•                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â•â•â•â•â•â•â•â•â•â•â•                    â”‚Joint 123â”‚
    â•â•â•â•â•â•â•â•â•â•â•                    â”‚ 1250 ft â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â†“
                                   â•â•â•â•â•â•â•â•â•â•â•
                                   â•â•â•â•â•â•â•â•â•â•â•
                                   â•â•â•â•â•â•â•â•â•â•â•
```

### Filters Section
```
Before:                          After:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Quick Actions   â”‚             â”‚ Quick Actions   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜ Show Labels   â”‚             â”‚ â˜ Show Labels   â”‚
â”‚ ğŸš¨ Next Criticalâ”‚             â”‚ ğŸš¨ Next Criticalâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚ ğŸ›ï¸ Show Filters â”‚ â† NEW
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â†“
â”‚ â–¼ Filters       â”‚             (Click to expand)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â†“
â”‚ Joint Range     â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Start] [End]   â”‚             â”‚ Joint Range     â”‚
â”‚ [Apply] [Reset] â”‚             â”‚ [S] [E]         â”‚ â† Smaller
â”‚                 â”‚             â”‚ [Apply] [Reset] â”‚
â”‚ Neighborhood    â”‚             â”‚                 â”‚
â”‚ [Center] [Rad]  â”‚             â”‚ Neighborhood    â”‚
â”‚ [Apply]         â”‚             â”‚ [C] [R]         â”‚ â† Smaller
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚ [Apply]         â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Critical Zones List
```
Before:                          After:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ #1  5.2%/yr     â”‚             â”‚ #1  5.2%/yr     â”‚
â”‚ Dist: 1250 ft   â”‚             â”‚ Dist: 1250 ft   â”‚
â”‚ Depth: 82.5%    â”‚             â”‚ Depth: 82.5%    â”‚
â”‚                 â”‚             â”‚ âš ï¸ Severe depth â”‚ â† NEW
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Algorithm: Hungarian Algorithm

### Visual Representation

```
2015 Anomalies          Cost Matrix          2022 Anomalies
    A1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 2.1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ B1
    A2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 3.5 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ B2
    A3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 1.8 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ B3
    A4 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ 4.2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ B4

Hungarian Algorithm finds optimal one-to-one matching:
    A1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ B1 âœ“
    A2 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ B3 âœ“
    A3 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ B2 âœ“
    A4 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ B4 âœ“

Minimizes total cost: 2.1 + 1.8 + 3.5 + 4.2 = 11.6
```

### Cost Calculation

```
Cost = âˆš[(Î”distance)Â² + (Î”orientation/30)Â²]

Example:
  A1: distance=1000ft, orientation=90Â°
  B1: distance=1002ft, orientation=95Â°
  
  Cost = âˆš[(1002-1000)Â² + (95-90)/30)Â²]
       = âˆš[4 + 0.028]
       = 2.01 ft
```

### Constraints

```
Hard Constraint: Distance Difference â‰¤ 5 ft

Valid Match:                    Invalid Match:
A: 1000 ft â”€â”€2ftâ”€â”€â†’ B: 1002 ft  A: 1000 ft â”€â”€8ftâ”€â”€â†’ B: 1008 ft
   âœ“ Allowed                       âœ— Rejected (cost = âˆ)
```

---

## Feature Comparison

| Feature | Before | After |
|---------|--------|-------|
| Legend Items | 7 | 3 |
| Joint Labels | Not working | âœ… Working |
| Critical Explanations | None | âœ… Added |
| Filter Visibility | Always visible | Toggle button |
| Filter Size | Large | Compact (30% smaller) |

---

## Algorithm Comparison

| Algorithm | Used? | Why/Why Not |
|-----------|-------|-------------|
| **Hungarian** | âœ… **YES** | Optimal, fast, handles constraints |
| DTW | âŒ No | For time series, not spatial points |
| ICP | âŒ No | Overkill for 2D data |
| Graph-based | âŒ No | Unnecessary complexity |
| Ensemble | âŒ No | Single metric sufficient |
| Deep Learning | âŒ No | Insufficient training data |

---

## Key Metrics

### Matching Parameters:
- **Distance Tolerance**: 5.0 ft
- **Orientation Scaling**: 30 deg/ft
- **Cost Threshold**: 1e6 (infinite)

### Critical Zone Thresholds:
- **Severe Depth**: â‰¥ 80%
- **Rapid Growth**: â‰¥ 5% per year
- **High Risk Combo**: Depth â‰¥60% AND Growth â‰¥2%/yr

---

## Testing Commands

```bash
# Start viewer
cd viewer
npm run dev

# Run matching algorithm
cd ..
python src/matching.py

# Run full pipeline
python src/ingestion.py
python src/create_master.py
python src/alignment.py
python src/matching.py
python src/analytics.py
```

---

## File Structure

```
project/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ matching.py          â† Hungarian Algorithm
â”‚   â”œâ”€â”€ alignment.py         â† Linear Interpolation
â”‚   â”œâ”€â”€ analytics.py         â† Growth Analysis
â”‚   â””â”€â”€ ...
â”œâ”€â”€ viewer/
â”‚   â”œâ”€â”€ index.html           â† UI (legend removed)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ main.js          â† Labels + filters
â”‚   â”‚   â””â”€â”€ style.css        â† Compact styling
â”‚   â””â”€â”€ ...
â”œâ”€â”€ ALGORITHM_EXPLANATION.md â† Detailed algorithm docs
â””â”€â”€ QUICK_REFERENCE.md       â† This file
```

---

## Summary

âœ… **Removed**: Tap, Tee, Weld from legend  
âœ… **Added**: Working joint labels feature  
âœ… **Added**: Critical zone explanations  
âœ… **Added**: Dedicated filter toggle button  
âœ… **Improved**: More compact filter design  
âœ… **Documented**: Hungarian Algorithm usage  

**Algorithm**: Hungarian (Optimal Bipartite Matching)  
**Preprocessing**: Linear Interpolation Alignment  
**Features**: Distance + Orientation  
**Constraint**: 5 ft tolerance  
